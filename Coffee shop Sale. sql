SELECT*FROM COFFEE;

CREATE OR REPLACE TABLE COFFEE AS 
(SELECT *, TRANSACTION_QTY*UNIT_PRICE AS TOTAL_SALE
FROM COFFEE);

ALTER TABLE COFFEE
ADD COLUMN TOTAL_SALE_2 FLOAT;

UPDATE COFFEE
SET TOTAL_SALE_2 = TRANSACTION_QTY*UNIT_PRICE;

ALTER TABLE COFFEE
DROP COLUMN TOTAL_SALE_2;

SELECT * 
FROM COFFEE
WHERE STORE_LOCATION  ILIKE '%T%';

SELECT SUM(TOTAL_SALE), STORE_LOCATION
FROM COFFEE
GROUP BY STORE_LOCATION;

SELECT SUM (TRANSACTION_QTY), PRODUCT_CATEGORY
FROM COFFEE
GROUP BY PRODUCT_CATEGORY
ORDER BY SUM (TRANSACTION_QTY) DESC;

SELECT *, 
       CASE
            WHEN TRANSACTION_TIME BETWEEN '06:00:00' AND '11:59:59' THEN 'MORNING'
            WHEN TRANSACTION_TIME BETWEEN '12:00:00' AND '17:59:59' THEN 'AFTERNOON'
            WHEN TRANSACTION_TIME BETWEEN '18:00:00' AND '21:00:00' THEN 'EVENING'
        END AS PERIOD_OF_DAY
FROM COFFEE;

SELECT MIN (TRANSACTION_TIME) AS OPEN_TIME, MAX (TRANSACTION_TIME) AS CLOSING_TIME
FROM COFFEE;

CREATE OR REPLACE TABLE COFFEE AS (
                                    SELECT *, 
       CASE
            WHEN TRANSACTION_TIME BETWEEN '06:00:00' AND '11:59:59' THEN 'MORNING'
            WHEN TRANSACTION_TIME BETWEEN '12:00:00' AND '17:59:59' THEN 'AFTERNOON'
            WHEN TRANSACTION_TIME BETWEEN '18:00:00' AND '21:00:00' THEN 'EVENING'
        END AS PERIOD_OF_DAY
FROM COFFEE
);

SELECT * FROM COFFEE
